<section class="main-content-section">
    <div class="row justify-content-center">
        <div class="col-lg-10 col-md-12">

            <div id="unity-container" class="unity-desktop">
                <canvas id="unity-canvas"></canvas>
            </div>

            <div id="loader-container">
            </div>

            <button id="fullscreen-button" class="fullscreen-btn" aria-label="Toggle Fullscreen">
                <i class="fa fa-arrows-alt"></i>
            </button>

        </div>
    </div>
</section>


<script>
    const buildUrl = "BuilderDemo/Build";
    const loaderUrl = buildUrl + "/BuilderDemo.loader.js";
    const config = {
        dataUrl: buildUrl + "/BuilderDemo.data.unityweb",
        frameworkUrl: buildUrl + "/BuilderDemo.framework.js.unityweb",
        codeUrl: buildUrl + "/BuilderDemo.wasm.unityweb",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Milos Milosavljevic",
        productName: "LobianToolkit Demo",
        productVersion: "1.0",
    };

    const canvas = document.querySelector("#unity-canvas");
    const loaderContainer = document.querySelector("#loader-container");
    const progressBar = document.querySelector("#unity-progress-bar");
    const loadingPercentage = document.querySelector("#loading-percentage");
    const fullscreenButton = document.querySelector("#fullscreen-button");

    // === UPDATED FULLSCREEN LOGIC ===
    const unityContainer = document.querySelector("#unity-container");

    fullscreenButton.onclick = () => {
        // Check if we are currently in fullscreen
        if (!document.fullscreenElement) {
            // Not fullscreen, so enter fullscreen
            // We request fullscreen on the *container* to avoid Unity's internal crash
            if (unityContainer.requestFullscreen) {
                unityContainer.requestFullscreen();
            } else if (unityContainer.mozRequestFullScreen) { /* Firefox */
                unityContainer.mozRequestFullScreen();
            } else if (unityContainer.webkitRequestFullscreen) { /* Chrome, Safari & Opera */
                unityContainer.webkitRequestFullscreen();
            } else if (unityContainer.msRequestFullscreen) { /* IE/Edge */
                unityContainer.msRequestFullscreen();
            }
        } else {
            // Is fullscreen, so exit
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.mozCancelFullScreen) { /* Firefox */
                document.mozCancelFullScreen();
            } else if (document.webkitExitFullscreen) { /* Chrome, Safari & Opera */
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE/Edge */
                document.msExitFullscreen();
            }
        }
    };
    // === END UPDATED LOGIC ===

    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
            const percentage = Math.round(progress * 100);
            progressBar.style.width = percentage + "%";
            loadingPercentage.textContent = percentage + "%";
        }).then((unityInstance) => {
            loaderContainer.style.opacity = '0';
            setTimeout(() => {
                loaderContainer.style.display = 'none';
            }, 500);

            // Note: We are no longer using unityInstance.SetFullscreen

        }).catch((message) => {
            alert(message);
        });
    };
    document.body.appendChild(script);
</script>
<footer class="footer__section">
</footer>
<script src="js/vendor/jquery-3.2.1.min.js"></script>
<script src="js/jquery.slicknav.min.js"></script>
<script src="js/slick.min.js"></script>
<script src="js/main.js"></script>

</body>
</html>